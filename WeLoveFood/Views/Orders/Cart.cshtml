@model CartViewModel

@{
    ViewBag.Title = "Поръчка -";

    var PriceFormat = "F2";
}

@section CartStyles {
    <link href="~/css/orders/cart.css" rel="stylesheet" />
}

<div class="cart-page-container">
    <div class="cart-container">
        <div class="meals">
            <div class="header">
                <h2>Твоите поръчки</h2>
                <p>@Model.CartAllPortions.Portions.Count() броя</p>
            </div>

            <div class="cards">
                <table>
                    <thead>
                        <tr>
                            <th>Ястие</th>
                            <th>Количество</th>
                            <th>Цена</th>
                            <th>Общо</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var portion in Model.CartAllPortions.Portions)
                        {
                            <tr>
                                <td class="meal">
                                    <h4>@portion.Meal.Name</h4>
                                    <div class="image-container">
                                        <img src="@portion.Meal.ImgUrl" alt="Meal" />
                                    </div>
                                </td>
                                <td class="quantity">
                                    <form method="post">
                                        <button id="remove-@portion.Id" class="remove @(portion.Quantity == 1 ? "disable" : string.Empty)" portion-id="@portion.Id">-</button>
                                    </form>
                                    <span id="number-@portion.Id" class="number">@portion.Quantity</span>
                                    <form method="post">
                                        <button class="add" portion-id="@portion.Id">+</button>
                                    </form>
                                </td>
                                <td class="price">
                                    @portion.Meal.Price.ToString(PriceFormat) лв
                                </td>
                                <td class="price">
                                    @portion.Price.ToString(PriceFormat) лв
                                </td>
                                <td class="remove-btn">
                                    <a><i class="fas fa-times"></i></a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
        <div class="order">
            <h2>Адрес за доставка</h2>

            <form class="order-info" method="post">
                <div class="info">
                    <label asp-for="PersonalData.FirstName"></label>
                    <input asp-for="PersonalData.FirstName" type="text" value="@Model.PersonalData.FirstName" />
                </div>
                <span asp-validation-for="PersonalData.FirstName" class="validation-message"></span>
                <div class="info">
                    <label asp-for="PersonalData.LastName"></label>
                    <input asp-for="PersonalData.LastName" type="text" value="@Model.PersonalData.LastName" />
                </div>
                <span asp-validation-for="PersonalData.LastName" class="validation-message"></span>
                <div class="info">
                    <label asp-for="PersonalData.PhoneNumber"></label>
                    <input asp-for="PersonalData.PhoneNumber" type="text" value="@Model.PersonalData.PhoneNumber" />
                </div>
                <span asp-validation-for="PersonalData.PhoneNumber" class="validation-message"></span>
                <div class="info">
                    <label asp-for="PersonalData.City"></label>
                    <input asp-for="PersonalData.City" type="text" value="@Model.PersonalData.City" />
                </div>
                <span asp-validation-for="PersonalData.City" class="validation-message"></span>
                <div class="info">
                    <label asp-for="PersonalData.Address"></label>
                    <input asp-for="PersonalData.Address" type="text" value="@Model.PersonalData.Address" />
                </div>
                <span asp-validation-for="PersonalData.Address" class="validation-message"></span>

                <div class="total-price">
                    <p>Цена за доставка: <span>@Model.CartAllPortions.DeliveryFee.ToString(PriceFormat)</span> лв</p>
                    <p>Обща цена: <span>@Model.CartAllPortions.TotalPrice.ToString(PriceFormat)</span> лв</p>
                </div>

                <input class="btn @(!Model.CartAllPortions.Portions.Any() ? "disable" : string.Empty)" type="submit" value="Поръчай" />
            </form>
        </div>
    </div>
</div>

@section CartScript {
    <script type="text/javascript" src="~/js/orders/removePortion.js"></script>
    <script type="text/javascript" src="~/js/orders/addPortion.js"></script>
}